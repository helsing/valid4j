
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2014-03-26
 Rendered using Reflow Maven Skin 1.1.0 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>valid4j</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/spacelab/bootstrap.min.css" rel="stylesheet" />
		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="./css/bootswatch.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />

		
		<link href="./css/lightbox.css" rel="stylesheet" />
		
		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />
		
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->



	</head>

	<body class="page-concepts project-valid4j" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="http://helsing.github.io/valid4j/">valid4j</a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Menu <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="index.html" title="Overview">Overview</a></li>
									<li class="active"><a href="" title="Concepts">Concepts</a></li>
									<li ><a href="apidocs/index.html" title="JavaDoc">JavaDoc</a></li>
									<li ><a href="faq.html" title="FAQ">FAQ</a></li>
									<li class="dropdown-submenu ">
										<a href="developer/notes.html" title="Developer notes">Developer notes</a>
										<ul class="dropdown-menu">
											<li ><a href="https://github.com/helsing/valid4j" title="View on GitHub" class="externalLink">View on GitHub</a></li>
											<li ><a href="https://github.com/helsing/valid4j/zipball/master" title="Download as .zip" class="externalLink">Download as .zip</a></li>
											<li ><a href="https://github.com/helsing/valid4j/tarball/master" title="Download as .tar.gz" class="externalLink">Download as .tar.gz</a></li>
										</ul>
									</li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li class="dropdown-submenu ">
										<a href="project-info.html" title="Project Information">Project Information</a>
										<ul class="dropdown-menu">
											<li ><a href="index.html" title="About">About</a></li>
											<li ><a href="plugin-management.html" title="Plugin Management">Plugin Management</a></li>
											<li ><a href="distribution-management.html" title="Distribution Management">Distribution Management</a></li>
											<li ><a href="dependency-info.html" title="Dependency Information">Dependency Information</a></li>
											<li ><a href="source-repository.html" title="Source Repository">Source Repository</a></li>
											<li ><a href="mail-lists.html" title="Mailing Lists">Mailing Lists</a></li>
											<li ><a href="issue-tracking.html" title="Issue Tracking">Issue Tracking</a></li>
											<li ><a href="integration.html" title="Continuous Integration">Continuous Integration</a></li>
											<li ><a href="plugins.html" title="Project Plugins">Project Plugins</a></li>
											<li ><a href="license.html" title="Project License">Project License</a></li>
											<li ><a href="team-list.html" title="Project Team">Project Team</a></li>
											<li ><a href="project-summary.html" title="Project Summary">Project Summary</a></li>
											<li ><a href="dependencies.html" title="Dependencies">Dependencies</a></li>
										</ul>
									</li>
									<li class="dropdown-submenu ">
										<a href="project-reports.html" title="Project Reports">Project Reports</a>
										<ul class="dropdown-menu">
											<li ><a href="apidocs/index.html" title="JavaDocs">JavaDocs</a></li>
										</ul>
									</li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
		
	<div class="container">
	
	<!-- Masthead
	================================================== -->

	<header>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span8">
			<div class="body-content">
<div class="section"> 
 <div class="page-header">
  <h2 id="Concepts">Concepts</h2>
 </div> 
 <p>Programming by contract is a simple, yet powerful, technique to achieve assertive programming. The basic idea of valid4j is to make a clear distinction between <i>programming errors</i> and <i>recoverable exceptions</i>. </p> 
 <div class="section"> 
  <h3 id="Programming_errors">Programming errors</h3> 
  <p>Programming errors are usually the result of an oversight of assumptions that really doesn't hold. This may result in logical contradictions, like trying to use a non-existent object (eg NullPointerException) or invoking a method with an argument that (eg IllegalArgumentException). These are logical errors that should be avoided already at design time. It doesn't make sense to <tt>try</tt> these invocations in order to <tt>catch</tt> and recover from them. Programming errors need to be corrected in the code at design time.</p> 
  <p>Needless to say, these kind of logical errors will still occur from time to time in a normally buggy program. Programming by contract gives us a technique to detect, expose, find and finally resolve bugs in our programs.</p> 
 </div> 
 <div class="section"> 
  <h3 id="Recoverable_exceptions">Recoverable exceptions</h3> 
  <p>Recoverable exceptions, on the other hand, signal exceptional cases that a correct program can and should handle gracefully. This might be network connection errors, file system errors or data input validation errors. This is what we in everyday talk refers to as error handling, fault tolerance and the like.</p> 
  <p>According to the Java exception hierarchy, as a general rule programming errors should inherit from <tt>RuntimeException</tt> whereas <tt>Error</tt> is reserved for internal errors of the Java runtime system.</p> 
  <p>However, there is also lots of differing opinions regarding the proper use of checked vs unchecked exceptions. This has led to the widespread use of <tt>RuntimeException</tt> also for recoverable exceptions.</p> 
  <p>Valid4J prefers to use <tt>Error</tt> to signal programming errors, and is agnostic to the question of checked vs unchecked recoverable exceptions.</p> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Defensive_programming">Defensive programming</h2> 
 <p>...a common, but sad example... </p> 
 <div> 
  <pre>// Example of client code with sad defensive programming
Object someParam;
...
Stuff result = supplier.method(someParam);
if (result == null) {
  // Some error handling
} else if (supplier.getState() == GREAT) {
  result.doWork();
} else {
  // Some more error handling
}

</pre> 
 </div> 
 <div> 
  <pre>// Example of supplier code with sad defensive programming
public Stuff method(Object param) {
  Stuff r;
  if (param == null) {
    // Some error handling
  } else if (getState() == GOOD) {
    r = a.doStuff();
  } else {
    // Even more error handling
  }
  return r;
</pre> 
 </div> 
 <p>The characteristic of the above code is that no one knows their responsibilities. No one knows what they are supposed to do or what others are supposed to do. Code is recognized by &quot;maybe&quot;/&quot;perhaps&quot;/&quot;if you're lucky&quot; statements, obscuring the real semantics and valid error handling. Are there any programming errors hidden in this code? How do I know? Defensive programming hides programming errors in a bloat of code and - which is worse - are handled as ordinary recoverable errors! Programming errors should not be dealt with this way. Fail fast, don't let bugs go undetected.</p> 
</div> 
<div class="section"> 
 <h2 id="Design_by_Contract_and_assertive_programming">Design by Contract and assertive programming</h2> 
 <p>Using contracts we can clarify the responsibilities between the calling side (client) and the called side (supplier). Contracts explicitly state what are your obligations and what are my obligations? A contract violation implies a logical error in the program. Therefore it doesn't make sense to try to recover from it. If you do, you're doing it wrong...</p> 
 <p>If a bug is detected in your application, it means it is in an unknown state, a state that your code is not prepared to handle. A reasonable <i>global</i> recovery policy would perhaps be to restart your application, return a HTTP 500 response or similar.</p> 
</div> 
<div class="section"> 
 <h2 id="Good_manners_to_keep">Good manners to keep</h2> 
 <p>If you are using contracts to clarify the responsibilities between clients and suppliers there are a couple of things to keep in mind. First, separate commands from queries. Your methods should have single well-defined responsibilities. Either they are commands, methods that change the current state. Or they are queries, side-effect free methods that return a result.</p> 
 <p>Separate commands from queries! Only use queries when specifying contracts == never use commands in contracts! The client shall always have the possibility to check the preconditions...</p> 
</div> 
<div class="section"> 
 <h2 id="Dont_use_contracts_for_error_handling_Dont_use_error_handling_for_contracts">Don't use contracts for error handling. Don't use error handling for contracts.</h2> 
 <p>Example country codes? Error handling at system boundaries. Never catch and try to recover from contract violations - you're doing it wrong if you do. Instead use the uncaughtExceptionHandler for global recovery.</p> 
</div> 
<div class="section"> 
 <h2 id="Invariants">Invariants</h2> 
 <p>Dragons be here...</p> 
</div> 
<div class="section"> 
 <h2 id="Contracts_and_inheritence">Contracts and inheritence</h2> 
 <p>LSP. Preconditions may be weakened for subclasses. Postconditions may be strengthened for subclasses. (it's not as easy as to say that contracts can simply be inherited by subclasses)</p> 
</div> 
<div class="section"> 
 <h2 id="Contracts_and_multi-threading">Contracts and multi-threading</h2> 
 <p>You can't put contracts on conditions that are outside your thread of control. Those conditions need to be dealt with using regular error handling, eg throw a recoverable exception.</p> 
</div> 
<div class="section"> 
 <h2 id="Contracts_and_unit_testing">Contracts and unit testing</h2> 
 <p>Contracts and unit testing complement each other. Leave the assertions on in production.</p> 
</div> 
<div class="section"> 
 <h2 id="Alternatives">Alternatives</h2> 
 <p>Google Guava, commons-lang Validate and Objects.requireNotNull.</p> 
</div> 
<div class="section"> 
 <h2 id="One-liners">One-liners</h2> 
 <p>Contracts help us detect, expose, find and fix bugs!</p> 
 <ul> 
  <li>Separate queries from commands</li> 
  <li>Only use side-effect free query methods when specifying contracts</li> 
  <li>Always make it possible for your clients to live up to their obligations (no hidden requires)</li> 
  <li>Do not try to catch and recover from contract violations (only at the top level is it relevant)</li> 
 </ul> 
 <hr /> 
</div> 
<div class="section"> 
 <h2 id="References">References</h2> 
 <ul> 
  <li><a class="externalLink" href="https://en.wikipedia.org/wiki/Design_by_Contract">Wikipedia, Design by Contract</a>.</li> 
  <li><a class="externalLink" href="http://www.academia.edu/4903777/Object-Oriented_Software_Construction_SECOND_EDITION">Object-Oriented Software Construction, Chapter 11, Design by Contract</a>.</li> 
  <li>The Pragmatic Programmer, Chapter 4, Design by Contract &amp; Assertive Programming.</li> 
  <li>Google.</li> 
 </ul> 
</div>
			</div>
		</div>
		<div class="span4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li class="dropdown"><a href="#Concepts" title="Concepts">Concepts <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Programming_errors" title="Programming errors">Programming errors</a>
		<li><a href="#Recoverable_exceptions" title="Recoverable exceptions">Recoverable exceptions</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li><a href="#Defensive_programming" title="Defensive programming">Defensive programming</a>
		<li><a href="#Design_by_Contract_and_assertive_programming" title="Design by Contract and assertive programming">Design by Contract and assertive programming</a>
		<li><a href="#Good_manners_to_keep" title="Good manners to keep">Good manners to keep</a>
		<li><a href="#Dont_use_contracts_for_error_handling_Dont_use_error_handling_for_contracts" title="Don't use contracts for error handling. Don't use error handling for contracts.">Don't use contracts for error handling. Don't use error handling for contracts.</a>
		<li><a href="#Invariants" title="Invariants">Invariants</a>
		<li><a href="#Contracts_and_inheritence" title="Contracts and inheritence">Contracts and inheritence</a>
		<li><a href="#Contracts_and_multi-threading" title="Contracts and multi-threading">Contracts and multi-threading</a>
		<li><a href="#Contracts_and_unit_testing" title="Contracts and unit testing">Contracts and unit testing</a>
		<li><a href="#Alternatives" title="Alternatives">Alternatives</a>
		<li><a href="#One-liners" title="One-liners">One-liners</a>
		<li><a href="#References" title="References">References</a>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->
	
	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span1 bottom-nav">
					<ul class="nav nav-list">
					</ul>
				</div>
			</div>
		</div>
	</footer>
		
	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2014 <a href="http://valid4j.org">Valid4J</a>. All Rights Reserved.</p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	
	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.js"></script>
	<script src="./js/jquery.smooth-scroll.min.js"></script>
	<!-- back button support for smooth scroll -->
	<script src="./js/jquery.ba-bbq.min.js"></script>

	<script src="./js/reflow-skin.js"></script>
	
	</body>
</html>
